<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             x:Class="RingGeneral.UI.Views.Trends.TrendsView"
             xmlns:vm="clr-namespace:RingGeneral.UI.ViewModels.Trends;assembly=RingGeneral.UI">

  <Design.DataContext>
    <vm:TrendsViewModel />
  </Design.DataContext>

  <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
    <StackPanel Margin="20" Spacing="20">

      <!-- Header -->
      <TextBlock Text="ðŸ“ˆ Gestion des Tendances"
                 FontSize="24"
                 FontWeight="Bold"
                 HorizontalAlignment="Center"
                 Margin="0,0,0,20"/>

      <!-- Refresh Button -->
      <Button Content="ðŸ”„ Actualiser Tendances"
              Command="{Binding RefreshCommand}"
              HorizontalAlignment="Right"
              Margin="0,0,0,10"/>

      <!-- Tendances Actives -->
      <Border BorderBrush="{DynamicResource ThemeBorderMidBrush}"
              BorderThickness="1"
              CornerRadius="8"
              Padding="15">
        <StackPanel Spacing="15">

          <TextBlock Text="ðŸŒŸ Tendances Actives"
                     FontSize="18"
                     FontWeight="SemiBold"
                     Margin="0,0,0,10"/>

          <ItemsControl ItemsSource="{Binding ActiveTrends}">
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <Border BorderBrush="{DynamicResource ThemeAccentBrush}"
                        BorderThickness="2"
                        CornerRadius="6"
                        Padding="12"
                        Margin="0,0,0,10"
                        Background="{DynamicResource ThemeAccentBrush3}">

                  <Grid ColumnDefinitions="*,Auto,Auto" Gap="15">

                    <!-- Informations de la tendance -->
                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                      <TextBlock Text="{Binding Name}"
                                 FontSize="16"
                                 FontWeight="SemiBold"
                                 Margin="0,0,0,4"/>
                      <TextBlock Text="{Binding Description}"
                                 FontSize="12"
                                 TextWrapping="Wrap"
                                 Opacity="0.8"
                                 Margin="0,0,0,4"/>
                      <StackPanel Orientation="Horizontal" Spacing="10">
                        <TextBlock Text="{Binding Type}"
                                   FontSize="11"
                                   Foreground="{DynamicResource ThemeAccentBrush}"/>
                        <TextBlock Text="{Binding Category}"
                                   FontSize="11"
                                   Foreground="{DynamicResource ThemeAccentBrush}"/>
                        <TextBlock Text="{Binding Intensity, StringFormat='IntensitÃ©: {0}'}"
                                   FontSize="11"
                                   Foreground="{DynamicResource ThemeAccentBrush}"/>
                      </StackPanel>
                    </StackPanel>

                    <!-- PÃ©nÃ©tration du marchÃ© -->
                    <Border Grid.Column="1"
                            BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="8"
                            Background="{DynamicResource ThemeBackgroundBrush}">
                      <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="ðŸ“Š PÃ©nÃ©tration"
                                   FontSize="10"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding MarketPenetration, StringFormat='{0:F1}%'}"
                                   FontSize="14"
                                   FontWeight="Bold"/>
                      </StackPanel>
                    </Border>

                    <!-- DurÃ©e restante -->
                    <Border Grid.Column="2"
                            BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="8"
                            Background="{DynamicResource ThemeBackgroundBrush}">
                      <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="â±ï¸ DurÃ©e"
                                   FontSize="10"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding DurationWeeks, StringFormat='{0} semaines'}"
                                   FontSize="12"/>
                      </StackPanel>
                    </Border>

                  </Grid>

                </Border>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>

          <TextBlock Text="Aucune tendance active"
                     FontSize="14"
                     HorizontalAlignment="Center"
                     IsVisible="{Binding ActiveTrends.Count, Converter={StaticResource CountToVisibilityConverter}, ConverterParameter=0}"/>

        </StackPanel>
      </Border>

      <!-- ADN du Roster -->
      <Border BorderBrush="{DynamicResource ThemeBorderMidBrush}"
              BorderThickness="1"
              CornerRadius="8"
              Padding="15">
        <StackPanel Spacing="15">

          <TextBlock Text="ðŸ§¬ ADN Actuel du Roster"
                     FontSize="18"
                     FontWeight="SemiBold"
                     Margin="0,0,0,10"/>

          <Grid ColumnDefinitions="*,*,*" Gap="15">

            <!-- Composition Stylistique -->
            <Border Grid.Column="0"
                    BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="10">
              <StackPanel Spacing="8">
                <TextBlock Text="ðŸŽ¨ Composition Stylistique"
                           FontSize="14"
                           FontWeight="SemiBold"
                           Margin="0,0,0,8"/>

                <TextBlock Text="{Binding CurrentDNA.HardcorePercentage, StringFormat='Hardcore: {0:F1}%'}"
                           FontSize="12"/>
                <TextBlock Text="{Binding CurrentDNA.TechnicalPercentage, StringFormat='Technical: {0:F1}%'}"
                           FontSize="12"/>
                <TextBlock Text="{Binding CurrentDNA.LuchaPercentage, StringFormat='Lucha: {0:F1}%'}"
                           FontSize="12"/>
                <TextBlock Text="{Binding CurrentDNA.EntertainmentPercentage, StringFormat='Entertainment: {0:F1}%'}"
                           FontSize="12"/>
                <TextBlock Text="{Binding CurrentDNA.StrongStylePercentage, StringFormat='Strong Style: {0:F1}%'}"
                           FontSize="12"/>
              </StackPanel>
            </Border>

            <!-- Style Dominant -->
            <Border Grid.Column="1"
                    BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="10">
              <StackPanel Spacing="8" VerticalAlignment="Center">
                <TextBlock Text="ðŸ‘‘ Style Dominant"
                           FontSize="14"
                           FontWeight="SemiBold"
                           Margin="0,0,0,8"/>
                <TextBlock Text="{Binding CurrentDNA.DominantStyle}"
                           FontSize="20"
                           FontWeight="Bold"
                           HorizontalAlignment="Center"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
              </StackPanel>
            </Border>

            <!-- Score de CohÃ©rence -->
            <Border Grid.Column="2"
                    BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="10">
              <StackPanel Spacing="8" VerticalAlignment="Center">
                <TextBlock Text="ðŸŽ¯ CohÃ©rence"
                           FontSize="14"
                           FontWeight="SemiBold"
                           Margin="0,0,0,8"/>
                <TextBlock Text="{Binding CurrentDNA.CoherenceScore, StringFormat='{0:F1}/100'}"
                           FontSize="20"
                           FontWeight="Bold"
                           HorizontalAlignment="Center"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
              </StackPanel>
            </Border>

          </Grid>

        </StackPanel>
      </Border>

      <!-- Matrice de CompatibilitÃ© -->
      <Border BorderBrush="{DynamicResource ThemeBorderMidBrush}"
              BorderThickness="1"
              CornerRadius="8"
              Padding="15">
        <StackPanel Spacing="15">

          <TextBlock Text="âš–ï¸ Matrice de CompatibilitÃ©"
                     FontSize="18"
                     FontWeight="SemiBold"
                     Margin="0,0,0,10"/>

          <ItemsControl ItemsSource="{Binding CompatibilityMatrices}">
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <Border BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="12"
                        Margin="0,0,0,8">

                  <Grid ColumnDefinitions="*,Auto,Auto,Auto,Auto" Gap="15">

                    <!-- Nom de la tendance -->
                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                      <TextBlock Text="{Binding TrendId}"
                                 FontSize="14"
                                 FontWeight="SemiBold"/>
                    </StackPanel>

                    <!-- Coefficient C -->
                    <Border Grid.Column="1"
                            BorderBrush="{DynamicResource ThemeAccentBrush}"
                            BorderThickness="2"
                            CornerRadius="4"
                            Padding="8"
                            Background="{DynamicResource ThemeAccentBrush3}">
                      <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="Coefficient C"
                                   FontSize="10"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding CompatibilityCoefficient, StringFormat='{0:F2}'}"
                                   FontSize="16"
                                   FontWeight="Bold"/>
                      </StackPanel>
                    </Border>

                    <!-- Niveau -->
                    <Border Grid.Column="2"
                            BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="8">
                      <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="Niveau"
                                   FontSize="10"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding Level}"
                                   FontSize="12"
                                   FontWeight="Bold"/>
                      </StackPanel>
                    </Border>

                    <!-- Bonus QualitÃ© -->
                    <Border Grid.Column="3"
                            BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="8">
                      <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="ðŸŽ­ Bonus QualitÃ©"
                                   FontSize="10"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding QualityBonus, StringFormat='+{0:F1}%'}"
                                   FontSize="14"
                                   FontWeight="Bold"/>
                      </StackPanel>
                    </Border>

                    <!-- Multiplicateur Croissance -->
                    <Border Grid.Column="4"
                            BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="8">
                      <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="ðŸ“ˆ Multiplicateur"
                                   FontSize="10"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding GrowthMultiplier, StringFormat='x{0:F2}'}"
                                   FontSize="14"
                                   FontWeight="Bold"/>
                      </StackPanel>
                    </Border>

                  </Grid>

                </Border>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>

          <TextBlock Text="Aucune matrice de compatibilitÃ© calculÃ©e"
                     FontSize="14"
                     HorizontalAlignment="Center"
                     IsVisible="{Binding CompatibilityMatrices.Count, Converter={StaticResource CountToVisibilityConverter}, ConverterParameter=0}"/>

        </StackPanel>
      </Border>

    </StackPanel>
  </ScrollViewer>

</UserControl>