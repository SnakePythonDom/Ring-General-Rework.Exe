<Window xmlns="https://github.com/avaloniaui"
	   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	   xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	   xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	   xmlns:vm="using:RingGeneral.UI.ViewModels.Core"
	   xmlns:vmDashboard="using:RingGeneral.UI.ViewModels.Dashboard"
	   xmlns:vmBooking="using:RingGeneral.UI.ViewModels.Booking"
	   xmlns:vmRoster="using:RingGeneral.UI.ViewModels.Roster"
	   xmlns:vmCompanyHub="using:RingGeneral.UI.ViewModels.CompanyHub"
	   xmlns:vmCompany="using:RingGeneral.UI.ViewModels.Company"
	   xmlns:vmStorylines="using:RingGeneral.UI.ViewModels.Storylines"
	   xmlns:vmYouth="using:RingGeneral.UI.ViewModels.Youth"
	   xmlns:vmFinance="using:RingGeneral.UI.ViewModels.Finance"
	   xmlns:vmCalendar="using:RingGeneral.UI.ViewModels.Calendar"
	   xmlns:vmOwnerBooker="using:RingGeneral.UI.ViewModels.OwnerBooker"
	   xmlns:vmCrisis="using:RingGeneral.UI.ViewModels.Crisis"
	   xmlns:vmStart="using:RingGeneral.UI.ViewModels.Start"
	   xmlns:vmInbox="using:RingGeneral.UI.ViewModels.Inbox"
	   xmlns:vmSettings="using:RingGeneral.UI.ViewModels.Settings"
	   xmlns:vmMedical="using:RingGeneral.UI.ViewModels.Medical"
	   xmlns:vmTrends="using:RingGeneral.UI.ViewModels.Trends"
	   xmlns:dashboard="using:RingGeneral.UI.Views.Dashboard"
	   xmlns:booking="using:RingGeneral.UI.Views.Booking"
	   xmlns:roster="using:RingGeneral.UI.Views.Roster"
	   xmlns:companyHub="using:RingGeneral.UI.Views.CompanyHub"
	   xmlns:company="using:RingGeneral.UI.Views.Company"
	   xmlns:storylines="using:RingGeneral.UI.Views.Storylines"
	   xmlns:youth="using:RingGeneral.UI.Views.Youth"
	   xmlns:finance="using:RingGeneral.UI.Views.Finance"
	   xmlns:calendar="using:RingGeneral.UI.Views.Calendar"
	   xmlns:ownerBooker="using:RingGeneral.UI.Views.OwnerBooker"
	   xmlns:crisis="using:RingGeneral.UI.Views.Crisis"
	   xmlns:start="using:RingGeneral.UI.Views.Start"
	   xmlns:inbox="using:RingGeneral.UI.Views.Inbox"
	   xmlns:settings="using:RingGeneral.UI.Views.Settings"
	   xmlns:medical="using:RingGeneral.UI.Views.Medical"
	   xmlns:trends="using:RingGeneral.UI.Views.Trends"
	   xmlns:shell="using:RingGeneral.UI.Views.Shell"
	   mc:Ignorable="d" d:DesignWidth="1600" d:DesignHeight="900"
	   x:Class="RingGeneral.UI.Views.Shell.MainWindow"
	   x:DataType="vm:ShellViewModel"
	   Title="RING GENERAL - Wrestling Management Simulation"
	   Width="1600"
	   Height="900"
	   WindowState="Maximized"
	   Icon="/Assets/icon.png"
	   Background="{StaticResource BackgroundPrimaryBrush}">

	<Design.DataContext>
		<vm:ShellViewModel />
	</Design.DataContext>

	<Window.DataTemplates>
		<DataTemplate DataType="vmDashboard:DashboardViewModel">
			<dashboard:DashboardView />
		</DataTemplate>
		<DataTemplate DataType="vmBooking:BookingViewModel">
			<booking:BookingView />
		</DataTemplate>
		<DataTemplate DataType="vmRoster:RosterViewModel">
			<roster:RosterView />
		</DataTemplate>
		<DataTemplate DataType="vmCompanyHub:CompanyHubViewModel">
			<companyHub:CompanyHubView />
		</DataTemplate>
		<DataTemplate DataType="vmStorylines:StorylinesViewModel">
			<storylines:StorylinesView />
		</DataTemplate>
		<DataTemplate DataType="vmYouth:YouthViewModel">
			<youth:YouthView />
		</DataTemplate>
		<DataTemplate DataType="vmFinance:FinanceViewModel">
			<finance:FinanceView />
		</DataTemplate>
		<DataTemplate DataType="vmCalendar:CalendarViewModel">
			<calendar:CalendarView />
		</DataTemplate>
		<DataTemplate DataType="vmOwnerBooker:OwnerBookerViewModel">
			<ownerBooker:OwnerBookerView />
		</DataTemplate>
		<DataTemplate DataType="vmCrisis:CrisisViewModel">
			<crisis:CrisisManagementView />
		</DataTemplate>
		<DataTemplate DataType="vmStart:StartViewModel">
			<start:StartView />
		</DataTemplate>
		<DataTemplate DataType="vmStart:CompanySelectorViewModel">
			<start:CompanySelectorView />
		</DataTemplate>
		<DataTemplate DataType="vmStart:CreateCompanyViewModel">
			<start:CreateCompanyView />
		</DataTemplate>
		<DataTemplate DataType="vmInbox:InboxViewModel">
			<inbox:InboxView />
		</DataTemplate>
		<DataTemplate DataType="vmSettings:SettingsViewModel">
			<settings:SettingsView />
		</DataTemplate>
		<DataTemplate DataType="vmMedical:MedicalViewModel">
			<medical:MedicalView />
		</DataTemplate>
        <!-- DataTemplate pour LibraryViewModel -->
        <DataTemplate DataType="vmBooking:LibraryViewModel">
            <booking:LibraryView />
        </DataTemplate>

        <!-- DataTemplate pour ShowHistoryPageViewModel -->
        <DataTemplate DataType="vmBooking:ShowHistoryPageViewModel">
            <booking:ShowHistoryPageView />
        </DataTemplate>

        <!-- DataTemplate pour ShellViewModel -->
        <DataTemplate DataType="vm:ShellViewModel">
            <shell:NavigationView />
        </DataTemplate>
        
        <!-- DataTemplate pour ChildCompanyBookingViewModel -->
        <DataTemplate DataType="vmCompany:ChildCompanyBookingViewModel">
            <company:ChildCompanyBookingView />
        </DataTemplate>
        
        <!-- DataTemplates pour Roster ViewModels -->
        <DataTemplate DataType="vmRoster:InjuriesViewModel">
            <roster:InjuriesView />
        </DataTemplate>
        <DataTemplate DataType="vmRoster:TitlesViewModel">
            <roster:TitlesView />
        </DataTemplate>
        <DataTemplate DataType="vmRoster:WorkerDetailViewModel">
            <roster:WorkerDetailView />
        </DataTemplate>
        <DataTemplate DataType="vmRoster:StructuralDashboardViewModel">
            <roster:StructuralDashboardView />
        </DataTemplate>
        
        <!-- DataTemplates pour Company ViewModels -->
        <DataTemplate DataType="vmCompany:ChildCompaniesViewModel">
            <company:ChildCompaniesView />
        </DataTemplate>
        <DataTemplate DataType="vmCompany:NicheManagementViewModel">
            <company:NicheManagementView />
        </DataTemplate>
        
        <!-- DataTemplate pour Trends ViewModel -->
        <DataTemplate DataType="vmTrends:TrendsViewModel">
            <trends:TrendsView />
        </DataTemplate>
        
        <!-- DataTemplate pour BookingSettingsViewModel -->
        <DataTemplate DataType="vmBooking:BookingSettingsViewModel">
            <booking:BookingSettingsView />
        </DataTemplate>
	</Window.DataTemplates>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="45"/>   <!-- Top Menu Bar -->
			<RowDefinition Height="*"/>    <!-- Content Area -->
			<RowDefinition Height="28"/>   <!-- Status Bar -->
		</Grid.RowDefinitions>

		<!-- ==================== TOP MENU BAR ==================== -->
		<Border Grid.Row="0" Background="{StaticResource BackgroundSecondaryBrush}" BorderBrush="{StaticResource BorderLightBrush}" BorderThickness="0,0,0,1" IsVisible="{Binding IsInGameMode}">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="300"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="Auto"/>
				</Grid.ColumnDefinitions>

				<!-- Left: Logo & Title -->
				<StackPanel Grid.Column="0" Orientation="Horizontal" Margin="15,0" VerticalAlignment="Center" Spacing="12">
					<!-- Logo: affiche l'image si disponible, sinon emoji -->
					<Panel Width="28" Height="28">
						<!-- Image logo (si le fichier existe) -->
						<Image Source="/Assets/logo-titlebar.png"
							   Width="28" Height="28"
							   IsVisible="True"/>
						<!-- Fallback emoji si l'image n'existe pas -->
						<TextBlock Text="??" FontSize="22"
								   HorizontalAlignment="Center"
								   VerticalAlignment="Center"
								   IsVisible="False"/>
					</Panel>
					<TextBlock Text="RING GENERAL" FontSize="14" FontWeight="Bold" Foreground="{StaticResource TextPrimaryBrush}" VerticalAlignment="Center"/>
				</StackPanel>

				<!-- Center: Current View Title -->
				<TextBlock Grid.Column="1" Text="{Binding CurrentViewTitle}" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center" HorizontalAlignment="Center"/>

				<!-- Right: Menu Buttons -->
				<StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,15,0" VerticalAlignment="Center" Spacing="8">
					<Button Content="??" ToolTip.Tip="Tableau de bord" Command="{Binding NavigateToDashboardCommand}" Background="Transparent" BorderThickness="0" Foreground="{StaticResource TextSecondaryBrush}" FontSize="14"/>
					<Button Content="??" ToolTip.Tip="Calendrier" Command="{Binding NavigateToCalendarCommand}" Background="Transparent" BorderThickness="0" Foreground="{StaticResource TextSecondaryBrush}" FontSize="14"/>
					<Button Content="??" ToolTip.Tip="Entreprise" Command="{Binding NavigateToCompanyCommand}" Background="Transparent" BorderThickness="0" Foreground="{StaticResource TextSecondaryBrush}" FontSize="14"/>
					<Button Content="??" ToolTip.Tip="Biblioth�que" Command="{Binding NavigateToLibraryCommand}" Background="Transparent" BorderThickness="0" Foreground="{StaticResource TextSecondaryBrush}" FontSize="14"/>
					<Button Content="??" ToolTip.Tip="Rapports" Command="{Binding NavigateToReportsCommand}" Background="Transparent" BorderThickness="0" Foreground="{StaticResource TextSecondaryBrush}" FontSize="14"/>
					<Button Content="??" ToolTip.Tip="Param�tres" Command="{Binding NavigateToSettingsCommand}" Background="Transparent" BorderThickness="0" Foreground="{StaticResource TextSecondaryBrush}" FontSize="14"/>
				</StackPanel>
			</Grid>
		</Border>

		<!-- ==================== CONTENT AREA ==================== -->
		<Grid Grid.Row="1">
			<!-- Start screens (when not in game mode) -->
			<ContentControl Content="{Binding CurrentContentViewModel}"
			                IsVisible="{Binding IsInGameMode, Converter={StaticResource InvertBoolConverter}}"
			                HorizontalAlignment="Stretch"
			                VerticalAlignment="Stretch"/>

			<!-- Game UI (when in game mode) -->
			<Grid IsVisible="{Binding IsInGameMode}">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="300"/>
					<ColumnDefinition Width="5"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="5"/>
					<ColumnDefinition Width="320"/>
				</Grid.ColumnDefinitions>

			<!-- Left Sidebar -->
			<Border Grid.Column="0" Background="{StaticResource BackgroundSecondaryBrush}" BorderBrush="{StaticResource BorderDefaultBrush}" BorderThickness="0,0,1,0" IsVisible="{Binding IsInGameMode}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="*"/>
					</Grid.RowDefinitions>

					<Border Grid.Row="0" Background="{StaticResource BackgroundTertiaryBrush}" Padding="20,15" BorderBrush="{StaticResource BorderLightBrush}" BorderThickness="0,0,0,1">
						<StackPanel Spacing="8">
							<TextBlock Text="NAVIGATION" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" FontWeight="SemiBold"/>
							<TextBlock Text="Menu principal" FontSize="16" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="Bold"/>
						</StackPanel>
					</Border>

					<ScrollViewer Grid.Row="1">
						<ContentControl Content="{Binding}" Margin="20"/>
					</ScrollViewer>
				</Grid>
			</Border>

			<GridSplitter Grid.Column="1" Background="{StaticResource BorderDefaultBrush}" ResizeDirection="Columns" IsVisible="{Binding IsInGameMode}"/>

			<!-- Main Content -->
			<Border Grid.Column="2" Background="{StaticResource BackgroundPrimaryBrush}" IsVisible="{Binding IsInGameMode}">
				<ContentControl Content="{Binding CurrentContentViewModel}" />
			</Border>

			<GridSplitter Grid.Column="3" Background="{StaticResource BorderDefaultBrush}" ResizeDirection="Columns" IsVisible="{Binding IsInGameMode}"/>

			<!-- Right Context Panel -->
			<Border Grid.Column="4" Background="{StaticResource BackgroundSecondaryBrush}" BorderBrush="{StaticResource BorderDefaultBrush}" BorderThickness="1,0,0,0" IsVisible="{Binding IsInGameMode}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="*"/>
					</Grid.RowDefinitions>
					<Border Grid.Row="0" Background="{StaticResource BackgroundTertiaryBrush}" Padding="20,15" BorderBrush="{StaticResource BorderLightBrush}" BorderThickness="0,0,0,1">
						<StackPanel Spacing="8">
							<TextBlock Text="PANNEAU DE CONTEXTE" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" FontWeight="SemiBold"/>
							<TextBlock Text="D�tails" FontSize="16" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="Bold"/>
						</StackPanel>
					</Border>
					<ScrollViewer Grid.Row="1">
						<ContentControl Content="{Binding CurrentContextViewModel}" Margin="20">
							<ContentControl.ContentTemplate>
								<DataTemplate>
									<TextBlock Text="S�lectionnez un �l�ment pour voir les d�tails" FontSize="13" Foreground="{StaticResource TextDisabledBrush}" TextWrapping="Wrap" HorizontalAlignment="Center" VerticalAlignment="Center"/>
								</DataTemplate>
							</ContentControl.ContentTemplate>
						</ContentControl>
					</ScrollViewer>
				</Grid>
			</Border>
		</Grid>
		</Grid>

		<!-- ==================== STATUS BAR ==================== -->
		<Border Grid.Row="2" Background="{StaticResource BackgroundSecondaryBrush}" BorderBrush="{StaticResource BorderLightBrush}" BorderThickness="0,1,0,0">
			<Grid Margin="15,0">
				<StackPanel Orientation="Horizontal" Spacing="15">
					<TextBlock Text="?? Sauvegarde automatique" FontSize="10" Foreground="{StaticResource TextDisabledBrush}" VerticalAlignment="Center"/>
					<TextBlock Text="�" FontSize="10" Foreground="{StaticResource TextDark}" VerticalAlignment="Center"/>
					<TextBlock Text="Derni�re sauvegarde : 14:32" FontSize="10" Foreground="{StaticResource TextDisabledBrush}" VerticalAlignment="Center"/>
				</StackPanel>
				<TextBlock Text="Ring General v1.0.0 � Build 2024.01" FontSize="10" Foreground="{StaticResource TextDark}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
			</Grid>
		</Border>
	</Grid>
</Window>