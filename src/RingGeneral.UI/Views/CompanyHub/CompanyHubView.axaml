<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:RingGeneral.UI.ViewModels.CompanyHub"
             mc:Ignorable="d" d:DesignWidth="1400" d:DesignHeight="900"
             x:Class="RingGeneral.UI.Views.CompanyHub.CompanyHubView"
             x:DataType="vm:CompanyHubViewModel">


  <Grid Background="{StaticResource BackgroundPrimaryBrush}" RowDefinitions="Auto,Auto,*">

    <!-- Header avec stats globales -->
    <Border Grid.Row="0"
            Background="{StaticResource BackgroundSecondaryBrush}"
            BorderBrush="{StaticResource BorderMediumBrush}"
            BorderThickness="0,0,0,1"
            Padding="24,16">
      <Grid ColumnDefinitions="*,Auto">
        <StackPanel Spacing="6">
          <TextBlock Text="RING GENERAL"
                     FontSize="22"
                     FontWeight="Bold"
                     Foreground="{StaticResource BrandPrimaryBrush}"/>
          <StackPanel Orientation="Horizontal" Spacing="20">
            <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
              <Run Text="TrÃ©sorerie: "/>
              <Run Text="{Binding CurrentCompany.Tresorerie, StringFormat='${0:N0}'}"
                   FontWeight="Bold"
                   Foreground="{StaticResource SuccessLightBrush}"/>
            </TextBlock>
            <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
              <Run Text="Date: "/>
              <Run Text="{Binding CurrentDateLabel}" FontWeight="Bold" Foreground="White"/>
            </TextBlock>
          </StackPanel>
        </StackPanel>
        <Button Grid.Column="1"
                Content="CONTINUER"
                Background="{StaticResource BrandPrimaryBrush}"
                Foreground="White"
                Padding="20,8"
                CornerRadius="8"
                FontWeight="Bold"/>
      </Grid>
    </Border>

    <!-- Header Company + Switch -->
    <Border Grid.Row="1" Background="{StaticResource BackgroundTertiaryBrush}" Padding="24,20">
      <Grid ColumnDefinitions="*,Auto">
        <StackPanel Orientation="Horizontal" Spacing="20">
          <Border Width="80"
                  Height="80"
                  CornerRadius="8"
                  Background="{Binding CompanyLogoBackground}">
            <TextBlock Text="{Binding CompanyLogoText}"
                       FontSize="28"
                       FontWeight="Black"
                       Foreground="White"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"/>
          </Border>

          <StackPanel Spacing="6">
            <StackPanel Orientation="Horizontal" Spacing="16">
              <TextBlock Text="{Binding CompanyDisplayTitle}"
                         FontSize="30"
                         FontWeight="Black"
                         Foreground="White"/>
              <Border Background="{StaticResource BackgroundCardDarkBrush}" BorderBrush="{StaticResource BorderMediumBrush}" BorderThickness="1" CornerRadius="16" Padding="4">
                <StackPanel Orientation="Horizontal" Spacing="4">
                  <RadioButton Classes="toggle-pill"
                               GroupName="CompanyMode"
                               Content="MA COMPAGNIE"
                               IsChecked="{Binding IsViewingMyCompany}"/>
                  <RadioButton Classes="toggle-pill"
                               GroupName="CompanyMode"
                               Content="RIVAUX"
                               IsChecked="{Binding IsViewingRival}"/>
                </StackPanel>
              </Border>
            </StackPanel>

            <StackPanel Orientation="Horizontal" Spacing="16">
              <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
                <Run Text="Prestige: "/>
                <Run Text="{Binding CurrentCompany.Prestige, StringFormat='National ({0}/100)'}" FontWeight="Bold" Foreground="White"/>
              </TextBlock>
              <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
                <Run Text="RÃ©gion: "/>
                <Run Text="{Binding CurrentCompany.Region}" FontWeight="Bold" Foreground="White"/>
              </TextBlock>
            </StackPanel>
          </StackPanel>
        </StackPanel>
      </Grid>
    </Border>

    <!-- Tabs -->
    <TabControl Grid.Row="2"
                SelectedIndex="{Binding SelectedTabIndex}"
                Background="{StaticResource BackgroundPrimaryBrush}"
                Padding="24">
      <TabControl.Styles>
        <Style Selector="TabStrip">
          <Setter Property="Background" Value="Transparent"/>
        </Style>
      </TabControl.Styles>

      <TabItem Header="VUE D'ENSEMBLE">
        <Grid ColumnDefinitions="2*,*" RowDefinitions="Auto">
          <StackPanel Grid.Column="0" Spacing="20">
            <Border Classes="card" BorderThickness="4,0,0,0" BorderBrush="{StaticResource BrandPrimaryBrush}">
              <StackPanel Spacing="16">
                <TextBlock Text="PROCHAIN Ã‰VÃ‰NEMENT"
                           FontSize="11"
                           FontWeight="Black"
                           Foreground="{StaticResource TextMutedBrush}"/>
                <Grid ColumnDefinitions="Auto,*,Auto">
                  <Border Width="64" Height="64" Background="{StaticResource BackgroundCardDarkBrush}" CornerRadius="6">
                    <TextBlock Text="ðŸ“…"
                               FontSize="24"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
                  </Border>
                  <StackPanel Grid.Column="1" Spacing="4">
                    <TextBlock Text="GFW MONDAY NIGHT" FontSize="20" FontWeight="Black" Foreground="White"/>
                    <TextBlock Text="Lundi Prochain | 20h00" FontSize="12" Foreground="{StaticResource BrandPrimaryBrush}"/>
                  </StackPanel>
                  <StackPanel Grid.Column="2" HorizontalAlignment="Right" Spacing="4">
                    <TextBlock Text="Barclays Center" FontSize="12" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Tickets: 85% Vendus" FontSize="11" Foreground="{StaticResource TextMutedBrush}"/>
                  </StackPanel>
                </Grid>
              </StackPanel>
            </Border>
          </StackPanel>

          <Border Grid.Column="1" Classes="card">
            <StackPanel Spacing="10">
              <TextBlock Text="PERFORMANCE RÃ‰CENTE"
                         FontSize="11"
                         FontWeight="Black"
                         Foreground="{StaticResource TextMutedBrush}"/>
              <TextBlock Text="7.8" FontSize="34" FontWeight="Black" Foreground="{StaticResource SuccessLightBrush}"/>
              <TextBlock Text="Moyenne Ratings (Derniers 4 shows)" FontSize="11" Foreground="{StaticResource TextMutedBrush}"/>
            </StackPanel>
          </Border>
        </Grid>
      </TabItem>

      <TabItem Header="ROSTER">
        <Border Classes="card">
          <TextBlock Text="ROSTER - CONTENU Ã€ VENIR"
                     FontSize="12"
                     FontWeight="Bold"
                     Foreground="{StaticResource TextMutedBrush}"/>
        </Border>
      </TabItem>

      <TabItem Header="TITRES">
        <Border Classes="card">
          <TextBlock Text="TITRES &amp; CHAMPIONS - CONTENU Ã€ VENIR"
                     FontSize="12"
                     FontWeight="Bold"
                     Foreground="{StaticResource TextMutedBrush}"/>
        </Border>
      </TabItem>

      <TabItem Header="FINANCES">
        <Border Classes="card">
          <TextBlock Text="FINANCES - CONTENU Ã€ VENIR"
                     FontSize="12"
                     FontWeight="Bold"
                     Foreground="{StaticResource TextMutedBrush}"/>
        </Border>
      </TabItem>

      <TabItem Header="FILIALES">
        <Border Classes="card" Padding="20">
          <StackPanel Spacing="16">
            <TextBlock Text="MES FILIALES"
                       FontSize="16"
                       FontWeight="Bold"
                       Foreground="White"/>
            
            <ItemsControl ItemsSource="{Binding PlayerCompanies}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Border Background="{StaticResource BackgroundCardDarkBrush}"
                          BorderBrush="{StaticResource BorderMediumBrush}"
                          BorderThickness="1"
                          CornerRadius="8"
                          Padding="16"
                          Margin="0,0,0,12">
                    <Grid ColumnDefinitions="*,Auto">
                      <StackPanel Spacing="8">
                        <TextBlock Text="{Binding ChildCompanyId}"
                                   FontSize="14"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <StackPanel Orientation="Horizontal" Spacing="12">
                          <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
                            <Run Text="Objectif: "/>
                            <Run Text="{Binding Objective}" FontWeight="Bold" Foreground="White"/>
                          </TextBlock>
                          <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
                            <Run Text="Autonomie: "/>
                            <Run Text="{Binding HasFullAutonomy}" FontWeight="Bold" Foreground="White"/>
                          </TextBlock>
                        </StackPanel>
                      </StackPanel>
                      <Button Grid.Column="1"
                              Content="RECRUTER MANAGER"
                              Command="{Binding DataContext.HireStaffCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                              CommandParameter="{Binding ChildCompanyId}"
                              Background="{StaticResource BrandPrimaryBrush}"
                              Foreground="White"
                              Padding="12,6"
                              CornerRadius="6"
                              FontWeight="Bold"/>
                    </Grid>
                  </Border>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>

            <TextBlock Text="{Binding PlayerCompanies.Count, StringFormat='Total: {0} filiale(s)'}"
                       FontSize="12"
                       Foreground="{StaticResource TextMutedBrush}"
                       HorizontalAlignment="Right"/>
          </StackPanel>
        </Border>
      </TabItem>

      <TabItem Header="YOUTH">
        <Grid RowDefinitions="Auto,*">
          <!-- Create New Structure -->
          <Border Grid.Row="0" Classes="card" Margin="0,0,0,20" Padding="16">
            <Grid ColumnDefinitions="*,Auto">
              <StackPanel Spacing="10">
                <TextBlock Text="CRÃ‰ER UNE NOUVELLE STRUCTURE"
                           FontSize="14"
                           FontWeight="Bold"
                           Foreground="{StaticResource TextMutedBrush}"/>

                <Grid ColumnDefinitions="*,*,Auto" RowDefinitions="Auto,Auto">
                  <StackPanel Grid.Column="0" Margin="0,0,16,0">
                    <TextBlock Text="Nom de la Structure" FontSize="11" Foreground="{StaticResource TextMutedBrush}" Margin="0,0,0,4"/>
                    <TextBox Text="{Binding NewYouthStructureName}" Watermark="Ex: Dojo Performance Center"/>
                  </StackPanel>

                  <StackPanel Grid.Column="1" Margin="0,0,16,0">
                    <TextBlock Text="Type" FontSize="11" Foreground="{StaticResource TextMutedBrush}" Margin="0,0,0,4"/>
                    <ComboBox ItemsSource="{Binding YouthStructureTypes}"
                              SelectedItem="{Binding NewYouthStructureType}"
                              HorizontalAlignment="Stretch"/>
                  </StackPanel>

                  <Button Grid.Column="2"
                          VerticalAlignment="Bottom"
                          Content="CRÃ‰ER"
                          Command="{Binding CreateYouthStructureCommand}"
                          Background="{StaticResource BrandPrimaryBrush}"
                          Foreground="White"
                          Padding="24,8"
                          CornerRadius="6"
                          FontWeight="Bold"/>
                </Grid>
              </StackPanel>
            </Grid>
          </Border>

          <!-- List Structures -->
          <Border Grid.Row="1" Classes="card" Padding="20">
            <Grid RowDefinitions="Auto,*,Auto">
              <TextBlock Grid.Row="0"
                         Text="MES STRUCTURES JEUNESSE"
                         FontSize="16"
                         FontWeight="Bold"
                         Foreground="White"
                         Margin="0,0,0,16"/>

              <ScrollViewer Grid.Row="1">
                <ItemsControl ItemsSource="{Binding YouthStructures}">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <Border Background="{StaticResource BackgroundCardDarkBrush}"
                              BorderBrush="{StaticResource BorderMediumBrush}"
                              BorderThickness="1"
                              CornerRadius="8"
                              Padding="16"
                              Margin="0,0,0,12">
                        <Grid ColumnDefinitions="*,Auto">
                          <StackPanel Spacing="8">
                            <TextBlock Text="{Binding Nom}"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       Foreground="White"/>
                            <StackPanel Orientation="Horizontal" Spacing="12">
                              <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
                                <Run Text="Type: "/>
                                <Run Text="{Binding Type}" FontWeight="Bold" Foreground="White"/>
                              </TextBlock>
                              <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
                                <Run Text="Niveau: "/>
                                <Run Text="{Binding NiveauEquipements}" FontWeight="Bold" Foreground="White"/>
                              </TextBlock>
                              <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
                                <Run Text="CapacitÃ©: "/>
                                <Run Text="{Binding CapaciteMax}" FontWeight="Bold" Foreground="White"/>
                              </TextBlock>
                              <TextBlock FontSize="12" Foreground="{StaticResource TextMutedBrush}">
                                <Run Text="Trainees: "/>
                                <Run Text="{Binding NbTrainees}" FontWeight="Bold" Foreground="White"/>
                              </TextBlock>
                            </StackPanel>
                          </StackPanel>
                          <Button Grid.Column="1"
                                  Content="GÃ‰RER"
                                  Background="{StaticResource BrandPrimaryBrush}"
                                  Foreground="White"
                                  Padding="12,6"
                                  CornerRadius="6"
                                  FontWeight="Bold"/>
                        </Grid>
                      </Border>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </ScrollViewer>

              <TextBlock Grid.Row="2"
                         Text="{Binding YouthStructures.Count, StringFormat='Total: {0} structure(s)'}"
                         FontSize="12"
                         Foreground="{StaticResource TextMutedBrush}"
                         HorizontalAlignment="Right"
                         Margin="0,16,0,0"/>
            </Grid>
          </Border>
        </Grid>
      </TabItem>
    </TabControl>
  </Grid>
</UserControl>
