<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             x:Class="RingGeneral.UI.Views.Company.NicheManagementView"
             xmlns:vm="clr-namespace:RingGeneral.UI.ViewModels.Company;assembly=RingGeneral.UI">

  <Design.DataContext>
    <vm:NicheManagementViewModel />
  </Design.DataContext>

  <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
    <StackPanel Margin="20" Spacing="20">

      <!-- Header -->
      <TextBlock Text="ðŸŽ¯ Gestion des FÃ©dÃ©rations de Niche"
                 FontSize="24"
                 FontWeight="Bold"
                 HorizontalAlignment="Center"
                 Margin="0,0,0,20"/>

      <!-- Statut Actuel -->
      <Border BorderBrush="{DynamicResource ThemeBorderMidBrush}"
              BorderThickness="1"
              CornerRadius="8"
              Padding="15">
        <StackPanel Spacing="15">

          <TextBlock Text="ðŸ“Š Statut Actuel"
                     FontSize="18"
                     FontWeight="SemiBold"
                     Margin="0,0,0,10"/>

          <Grid ColumnDefinitions="*,*,*" Gap="15">

            <!-- FÃ©dÃ©ration de Niche -->
            <Border Grid.Column="0"
                    BorderBrush="{DynamicResource ThemeAccentBrush}"
                    BorderThickness="2"
                    CornerRadius="6"
                    Padding="15"
                    Background="{DynamicResource ThemeAccentBrush3}">
              <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="8">
                <TextBlock Text="{Binding IsNicheFederation, Converter={StaticResource BoolToTextConverter}, ConverterParameter='Oui|Non'}"
                           FontSize="18"
                           FontWeight="Bold"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
                <TextBlock Text="FÃ©dÃ©ration de Niche"
                           FontSize="12"
                           HorizontalAlignment="Center"/>
              </StackPanel>
            </Border>

            <!-- Type de Niche -->
            <Border Grid.Column="1"
                    BorderBrush="{DynamicResource ThemeAccentBrush}"
                    BorderThickness="2"
                    CornerRadius="6"
                    Padding="15"
                    Background="{DynamicResource ThemeAccentBrush3}">
              <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="8">
                <TextBlock Text="{Binding NicheType}"
                           FontSize="16"
                           FontWeight="Bold"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
                <TextBlock Text="Type de Niche"
                           FontSize="12"
                           HorizontalAlignment="Center"/>
              </StackPanel>
            </Border>

            <!-- Ã‰tat du Profil -->
            <Border Grid.Column="2"
                    BorderBrush="{DynamicResource ThemeAccentBrush}"
                    BorderThickness="2"
                    CornerRadius="6"
                    Padding="15"
                    Background="{DynamicResource ThemeAccentBrush3}">
              <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="8">
                <TextBlock Text="{Binding CurrentProfile.EstablishedAt, StringFormat='Ã‰tablie\\n{0:dd/MM/yyyy}', TargetNullValue='Non Ã©tablie'}"
                           FontSize="12"
                           FontWeight="Bold"
                           TextAlignment="Center"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
                <TextBlock Text="Date d'Ã©tablissement"
                           FontSize="10"
                           HorizontalAlignment="Center"/>
              </StackPanel>
            </Border>

          </Grid>

        </StackPanel>
      </Border>

      <!-- Avantages Ã‰conomiques (si niche active) -->
      <Border BorderBrush="{DynamicResource ThemeBorderMidBrush}"
              BorderThickness="1"
              CornerRadius="8"
              Padding="15"
              IsVisible="{Binding IsNicheFederation}">
        <StackPanel Spacing="15">

          <TextBlock Text="ðŸ’° Avantages Ã‰conomiques de la Niche"
                     FontSize="18"
                     FontWeight="SemiBold"
                     Margin="0,0,0,10"/>

          <Grid ColumnDefinitions="*,*,*" Gap="15">

            <!-- Audience Captive -->
            <Border Grid.Column="0"
                    BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12">
              <StackPanel HorizontalAlignment="Center" Spacing="8">
                <TextBlock Text="ðŸ‘¥ Audience Captive"
                           FontSize="14"
                           FontWeight="SemiBold"/>
                <TextBlock Text="{Binding CurrentProfile.CaptiveAudiencePercentage, StringFormat='{0:F1}%'}"
                           FontSize="20"
                           FontWeight="Bold"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
                <TextBlock Text="Public fidÃ¨le"
                           FontSize="10"
                           Opacity="0.7"/>
              </StackPanel>
            </Border>

            <!-- Multiplicateur Merchandise -->
            <Border Grid.Column="1"
                    BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12">
              <StackPanel HorizontalAlignment="Center" Spacing="8">
                <TextBlock Text="ðŸ›ï¸ Merchandise"
                           FontSize="14"
                           FontWeight="SemiBold"/>
                <TextBlock Text="{Binding CurrentProfile.MerchandiseMultiplier, StringFormat='x{0:F1}'}"
                           FontSize="20"
                           FontWeight="Bold"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
                <TextBlock Text="Multiplicateur"
                           FontSize="10"
                           Opacity="0.7"/>
              </StackPanel>
            </Border>

            <!-- StabilitÃ© Billetterie -->
            <Border Grid.Column="2"
                    BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12">
              <StackPanel HorizontalAlignment="Center" Spacing="8">
                <TextBlock Text="ðŸŽ« Billetterie"
                           FontSize="14"
                           FontWeight="SemiBold"/>
                <TextBlock Text="{Binding CurrentProfile.TicketSalesStability, StringFormat='{0:F1}%'}"
                           FontSize="20"
                           FontWeight="Bold"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
                <TextBlock Text="StabilitÃ©"
                           FontSize="10"
                           Opacity="0.7"/>
              </StackPanel>
            </Border>

          </Grid>

          <Separator/>

          <Grid ColumnDefinitions="*,*" Gap="15">

            <!-- LoyautÃ© des Talents -->
            <Border Grid.Column="0"
                    BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12">
              <StackPanel HorizontalAlignment="Center" Spacing="8">
                <TextBlock Text="ðŸ¤ LoyautÃ© Talents"
                           FontSize="14"
                           FontWeight="SemiBold"/>
                <TextBlock Text="{Binding CurrentProfile.TalentLoyaltyBonus, StringFormat='+{0:F1}%'}"
                           FontSize="18"
                           FontWeight="Bold"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
                <TextBlock Text="Bonus fidÃ©litÃ©"
                           FontSize="10"
                           Opacity="0.7"/>
              </StackPanel>
            </Border>

            <!-- RÃ©duction Salaires -->
            <Border Grid.Column="1"
                    BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12">
              <StackPanel HorizontalAlignment="Center" Spacing="8">
                <TextBlock Text="ðŸ’¸ RÃ©duction Salaires"
                           FontSize="14"
                           FontWeight="SemiBold"/>
                <TextBlock Text="{Binding CurrentProfile.TalentSalaryReduction, StringFormat='- {0:F1}%'}"
                           FontSize="18"
                           FontWeight="Bold"
                           Foreground="{DynamicResource ThemeAccentBrush}"/>
                <TextBlock Text="Demande rÃ©duite"
                           FontSize="10"
                           Opacity="0.7"/>
              </StackPanel>
            </Border>

          </Grid>

        </StackPanel>
      </Border>

      <!-- Actions -->
      <Border BorderBrush="{DynamicResource ThemeBorderMidBrush}"
              BorderThickness="1"
              CornerRadius="8"
              Padding="15">
        <StackPanel Spacing="15">

          <TextBlock Text="âš™ï¸ Actions de Gestion"
                     FontSize="18"
                     FontWeight="SemiBold"
                     Margin="0,0,0,10"/>

          <Grid ColumnDefinitions="*,*" Gap="15">

            <!-- Ã‰tablir une Niche -->
            <Border Grid.Column="0"
                    BorderBrush="{DynamicResource ThemeAccentBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="15">
              <StackPanel Spacing="10">
                <TextBlock Text="ðŸ—ï¸ Ã‰tablir une Niche"
                           FontSize="16"
                           FontWeight="SemiBold"/>
                <ComboBox x:Name="NicheTypeComboBox"
                         ItemsSource="{Binding Source={StaticResource NicheTypes}}"
                         SelectedItem="{Binding NicheType}"
                         PlaceholderText="SÃ©lectionner un type de niche"/>
                <Button Content="ðŸš€ Ã‰tablir Niche"
                        Command="{Binding EstablishNicheCommand}"
                        CommandParameter="{Binding #NicheTypeComboBox.SelectedItem}"
                        IsEnabled="{Binding IsNicheFederation, Converter={StaticResource InvertBoolConverter}}"
                        HorizontalAlignment="Stretch"/>
              </StackPanel>
            </Border>

            <!-- Abandonner la Niche -->
            <Border Grid.Column="1"
                    BorderBrush="{DynamicResource ThemeAccentBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="15">
              <StackPanel Spacing="10">
                <TextBlock Text="ðŸ Abandonner la Niche"
                           FontSize="16"
                           FontWeight="SemiBold"/>
                <TextBlock Text="âš ï¸ Cette action est irrÃ©versible et peut affecter votre base de fans."
                           FontSize="11"
                           TextWrapping="Wrap"
                           Opacity="0.8"/>
                <Button Content="âŒ Abandonner Niche"
                        Command="{Binding AbandonNicheCommand}"
                        IsEnabled="{Binding IsNicheFederation}"
                        HorizontalAlignment="Stretch"
                        Background="Red"
                        Foreground="White"/>
              </StackPanel>
            </Border>

          </Grid>

          <!-- Ã‰valuation de ViabilitÃ© -->
          <Border BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                  BorderThickness="1"
                  CornerRadius="6"
                  Padding="15"
                  Margin="0,10,0,0">
            <StackPanel Spacing="10">
              <TextBlock Text="ðŸ” Ã‰valuation de ViabilitÃ©"
                         FontSize="16"
                         FontWeight="SemiBold"/>
              <TextBlock Text="Obtenir une analyse complÃ¨te de la viabilitÃ© d'une stratÃ©gie de niche avant de s'y engager."
                         FontSize="12"
                         TextWrapping="Wrap"
                         Opacity="0.8"/>
              <Button Content="ðŸ“Š Ã‰valuer ViabilitÃ©"
                      Command="{Binding EvaluateNicheCommand}"
                      CommandParameter="{Binding #NicheTypeComboBox.SelectedItem}"
                      HorizontalAlignment="Stretch"/>
            </StackPanel>
          </Border>

        </StackPanel>
      </Border>

    </StackPanel>
  </ScrollViewer>

</UserControl>