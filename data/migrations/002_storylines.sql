PRAGMA foreign_keys = ON;

ALTER TABLE Storylines ADD COLUMN Phase TEXT NOT NULL DEFAULT 'BUILD';
ALTER TABLE Storylines ADD COLUMN Status TEXT NOT NULL DEFAULT 'ACTIVE';
ALTER TABLE Storylines ADD COLUMN Summary TEXT;

CREATE TABLE IF NOT EXISTS StorylineEvents (
    StorylineEventId INTEGER PRIMARY KEY AUTOINCREMENT,
    StorylineId TEXT NOT NULL,
    EventType TEXT NOT NULL,
    EventWeek INTEGER,
    Details TEXT,
    CreatedAt TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (StorylineId) REFERENCES Storylines(StorylineId)
);
